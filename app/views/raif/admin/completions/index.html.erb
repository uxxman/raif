<h1 class="mb-4"><%= t(".title") %></h1>

<div class="row">
  <div class="col-12">
    <% if @completions.any? %>
      <div class="table-responsive">
        <table class="table table-striped table-hover">
          <thead class="table-light">
            <tr>
              <th><%= t("raif.admin.common.id") %></th>
              <th><%= t("raif.admin.common.created_at") %></th>
              <th><%= t("raif.admin.common.creator") %></th>
              <th><%= t("raif.admin.common.model") %></th>
              <th><%= t("raif.admin.common.status") %></th>
              <th><%= t("raif.admin.common.prompt_tokens") %></th>
              <th><%= t("raif.admin.common.completion_tokens") %></th>
              <th><%= t("raif.admin.common.prompt") %></th>
            </tr>
          </thead>
          <tbody>
            <% @completions.each do |completion| %>
              <tr>
                <td><%= link_to "##{completion.id}", raif.admin_completion_path(completion) %></td>
                <td><small class="text-muted"><%= completion.created_at.strftime("%Y-%m-%d %H:%M:%S") %></small></td>
                <td><%= completion.creator_type %> #<%= completion.creator_id %></td>
                <td><%= completion.llm_model_name %></td>
                <td>
                  <% if completion.completed_at? %>
                    <span class="badge bg-success">Completed</span>
                  <% elsif completion.failed_at? %>
                    <span class="badge bg-danger">Failed</span>
                  <% elsif completion.started_at? %>
                    <span class="badge bg-warning text-dark">In Progress</span>
                  <% else %>
                    <span class="badge bg-secondary">Pending</span>
                  <% end %>
                </td>
                <td><%= completion.prompt_tokens %></td>
                <td><%= completion.completion_tokens %></td>
                <td><small class="text-muted"><%= truncate(completion.prompt, length: 100) %></small></td>
              </tr>
            <% end %>
          </tbody>
        </table>
      </div>
      
      <div class="mt-4">
        <%== pagy_bootstrap_nav(@pagy) %>
      </div>
    <% else %>
      <div class="alert alert-info">
        <%= t("raif.admin.common.no_completions") %>
      </div>
    <% end %>
  </div>
</div> 