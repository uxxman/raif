<div class="d-flex justify-content-between align-items-center my-4">
  <h1 class="mb-0"><%= t("raif.admin.common.stats") %></h1>
  
  <div class="period-filter">
    <%= form_tag raif.admin_stats_path, method: :get, id: "period_filter_form", class: "d-flex align-items-center" do %>
      <%= select_tag :period, 
        options_for_select([
          [t("raif.admin.common.period_day"), "day"],
          [t("raif.admin.common.period_week"), "week"],
          [t("raif.admin.common.period_month"), "month"],
          [t("raif.admin.common.period_all"), "all"]
        ], @selected_period),
        class: "form-select form-select-sm me-2"
      %>
      <%= submit_tag t("raif.admin.common.update"), class: "btn btn-sm btn-primary" %>
    <% end %>
  </div>
</div>

<div class="row">
  <div class="col-12">
    <div class="card shadow-sm mb-4">
      <div class="card-body">
        <div class="row g-4">
          <!-- Model Completions -->
          <div class="col-md-4 col-lg-4">
            <div class="stats-card p-3 border rounded shadow-sm h-100">
              <div class="d-flex align-items-center mb-2">
                <span class="stats-icon bg-primary-subtle text-primary rounded p-2 me-3">
                  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-robot" viewBox="0 0 16 16">
                    <path d="M6 12.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 0 1h-3a.5.5 0 0 1-.5-.5ZM3 8.062C3 6.76 4.235 5.765 5.53 5.886a26.58 26.58 0 0 0 4.94 0C11.765 5.765 13 6.76 13 8.062v1.157a.933.933 0 0 1-.765.935c-.845.147-2.34.346-4.235.346-1.895 0-3.39-.2-4.235-.346A.933.933 0 0 1 3 9.219V8.062Zm4.542-.827a.25.25 0 0 0-.217.068l-.92.9a24.767 24.767 0 0 1-1.871-.183.25.25 0 0 0-.068.495c.55.076 1.232.149 2.02.193a.25.25 0 0 0 .189-.071l.754-.736.847 1.71a.25.25 0 0 0 .404.062l.932-.97a25.286 25.286 0 0 0 1.922-.188.25.25 0 0 0-.068-.495c-.538.074-1.207.145-1.98.189a.25.25 0 0 0-.166.076l-.754.785-.842-1.7a.25.25 0 0 0-.182-.135Z" />
                    <path d="M8.5 1.866a1 1 0 1 0-1 0V3h-2A4.5 4.5 0 0 0 1 7.5V8a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1v1a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2v-1a1 1 0 0 0 1-1V9a1 1 0 0 0-1-1v-.5A4.5 4.5 0 0 0 10.5 3h-2V1.866ZM14 7.5V13a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V7.5A3.5 3.5 0 0 1 5.5 4h5A3.5 3.5 0 0 1 14 7.5Z" />
                  </svg>
                </span>
                <div>
                  <h6 class="mb-0 text-muted">Model Completions</h6>
                </div>
              </div>
              <h3 class="fw-bold mb-0"><%= number_with_delimiter(@model_completion_count) %></h3>
              <p class="text-muted mt-2 mb-0"><small>Cost: <%= number_to_currency(@model_completion_total_cost, precision: 6) %></small></p>
            </div>
          </div>
          
          <!-- Tasks -->
          <div class="col-md-4 col-lg-4">
            <div class="stats-card p-3 border rounded shadow-sm h-100">
              <div class="d-flex align-items-center mb-2">
                <span class="stats-icon bg-success-subtle text-success rounded p-2 me-3">
                  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-list-check" viewBox="0 0 16 16">
                    <path fill-rule="evenodd" d="M5 11.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5zM3.854 2.146a.5.5 0 0 1 0 .708l-1.5 1.5a.5.5 0 0 1-.708 0l-.5-.5a.5.5 0 1 1 .708-.708L2 3.293l1.146-1.147a.5.5 0 0 1 .708 0zm0 4a.5.5 0 0 1 0 .708l-1.5 1.5a.5.5 0 0 1-.708 0l-.5-.5a.5.5 0 1 1 .708-.708L2 7.293l1.146-1.147a.5.5 0 0 1 .708 0zm0 4a.5.5 0 0 1 0 .708l-1.5 1.5a.5.5 0 0 1-.708 0l-.5-.5a.5.5 0 0 1 .708-.708l.146.147 1.146-1.147a.5.5 0 0 1 .708 0z" />
                  </svg>
                </span>
                <div>
                  <h6 class="mb-0 text-muted">Tasks</h6>
                </div>
              </div>
              <div class="d-flex justify-content-between align-items-center">
                <h3 class="fw-bold mb-0"><%= number_with_delimiter(@task_count) %></h3>
                <div class="mt-2">
                  <%= link_to t("raif.admin.common.details"), raif.admin_stats_tasks_path(period: @selected_period) %>
                </div>
              </div>
            </div>
          </div>
          
          <!-- Conversations -->
          <div class="col-md-4 col-lg-4">
            <div class="stats-card p-3 border rounded shadow-sm h-100">
              <div class="d-flex align-items-center mb-2">
                <span class="stats-icon bg-info-subtle text-info rounded p-2 me-3">
                  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-chat-dots" viewBox="0 0 16 16">
                    <path d="M5 8a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm4 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm3 1a1 1 0 1 0 0-2 1 1 0 0 0 0 2z" />
                    <path d="m2.165 15.803.02-.004c1.83-.363 2.948-.842 3.468-1.105A9.06 9.06 0 0 0 8 15c4.418 0 8-3.134 8-7s-3.582-7-8-7-8 3.134-8 7c0 1.76.743 3.37 1.97 4.6a10.437 10.437 0 0 1-.524 2.318l-.003.011a10.722 10.722 0 0 1-.244.637c-.079.186.074.394.273.362a21.673 21.673 0 0 0 .693-.125zm.8-3.108a1 1 0 0 0-.287-.801C1.618 10.83 1 9.468 1 8c0-3.192 3.004-6 7-6s7 2.808 7 6c0 3.193-3.004 6-7 6a8.06 8.06 0 0 1-2.088-.272a1 1 0 0 0-.711.074c-.387.196-1.24.57-2.634.893a10.97 10.97 0 0 0 .398-2z" />
                  </svg>
                </span>
                <div>
                  <h6 class="mb-0 text-muted">Conversations</h6>
                </div>
              </div>
              <h3 class="fw-bold mb-0"><%= number_with_delimiter(@conversation_count) %></h3>
            </div>
          </div>
          
          <!-- Conversation Entries -->
          <div class="col-md-4 col-lg-4">
            <div class="stats-card p-3 border rounded shadow-sm h-100">
              <div class="d-flex align-items-center mb-2">
                <span class="stats-icon bg-warning-subtle text-warning rounded p-2 me-3">
                  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-chat-text" viewBox="0 0 16 16">
                    <path d="M2.678 11.894a1 1 0 0 1 .287.801 10.97 10.97 0 0 1-.398 2c1.395-.323 2.247-.697 2.634-.893a1 1 0 0 1 .71-.074A8.06 8.06 0 0 0 8 14c3.996 0 7-2.807 7-6 0-3.192-3.004-6-7-6S1 4.808 1 8c0 1.468.617 2.83 1.678 3.894zm-.493 3.905a21.682 21.682 0 0 1-.713.129c-.2.032-.352-.176-.273-.362a9.68 9.68 0 0 0 .244-.637l.003-.01c.248-.72.45-1.548.524-2.319C.743 11.37 0 9.76 0 8c0-3.866 3.582-7 8-7s8 3.134 8 7-3.582 7-8 7a9.06 9.06 0 0 1-2.347-.306c-.52.263-1.639.742-3.468 1.105z"/>
                    <path d="M4 5.5a.5.5 0 0 1 .5-.5h7a.5.5 0 0 1 0 1h-7a.5.5 0 0 1-.5-.5zM4 8a.5.5 0 0 1 .5-.5h7a.5.5 0 0 1 0 1h-7A.5.5 0 0 1 4 8zm0 2.5a.5.5 0 0 1 .5-.5h4a.5.5 0 0 1 0 1h-4a.5.5 0 0 1-.5-.5z"/>
                  </svg>
                </span>
                <div>
                  <h6 class="mb-0 text-muted">Conversation Entries</h6>
                </div>
              </div>
              <h3 class="fw-bold mb-0"><%= number_with_delimiter(@conversation_entry_count) %></h3>
            </div>
          </div>
          
          <!-- Agents -->
          <div class="col-md-4 col-lg-4">
            <div class="stats-card p-3 border rounded shadow-sm h-100">
              <div class="d-flex align-items-center mb-2">
                <span class="stats-icon bg-danger-subtle text-danger rounded p-2 me-3">
                  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-cpu" viewBox="0 0 16 16">
                    <path d="M5 0a.5.5 0 0 1 .5.5V2h1V.5a.5.5 0 0 1 1 0V2h1V.5a.5.5 0 0 1 1 0V2h1V.5a.5.5 0 0 1 1 0V2A2.5 2.5 0 0 1 14 4.5h1.5a.5.5 0 0 1 0 1H14v1h1.5a.5.5 0 0 1 0 1H14v1h1.5a.5.5 0 0 1 0 1H14v1h1.5a.5.5 0 0 1 0 1H14a2.5 2.5 0 0 1-2.5 2.5v1.5a.5.5 0 0 1-1 0V14h-1v1.5a.5.5 0 0 1-1 0V14h-1v1.5a.5.5 0 0 1-1 0V14h-1v1.5a.5.5 0 0 1-1 0V14A2.5 2.5 0 0 1 2 11.5H.5a.5.5 0 0 1 0-1H2v-1H.5a.5.5 0 0 1 0-1H2v-1H.5a.5.5 0 0 1 0-1H2v-1H.5a.5.5 0 0 1 0-1H2A2.5 2.5 0 0 1 4.5 2V.5A.5.5 0 0 1 5 0zm-.5 3A1.5 1.5 0 0 0 3 4.5v7A1.5 1.5 0 0 0 4.5 13h7a1.5 1.5 0 0 0 1.5-1.5v-7A1.5 1.5 0 0 0 11.5 3h-7zM5 6.5A1.5 1.5 0 0 1 6.5 5h3A1.5 1.5 0 0 1 11 6.5v3A1.5 1.5 0 0 1 9.5 11h-3A1.5 1.5 0 0 1 5 9.5v-3zM6.5 6a.5.5 0 0 0-.5.5v3a.5.5 0 0 0 .5.5h3a.5.5 0 0 0 .5-.5v-3a.5.5 0 0 0-.5-.5h-3z" />
                  </svg>
                </span>
                <div>
                  <h6 class="mb-0 text-muted">Agents</h6>
                </div>
              </div>
              <h3 class="fw-bold mb-0"><%= number_with_delimiter(@agent_count) %></h3>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

